# This is an example .goreleaser.yml file with some sensible defaults.
# Make sure to check the documentation at https://goreleaser.com

# The lines below are called `modelines`. See `:help modeline`
# Feel free to remove those if you don't want/need to use them.
# yaml-language-server: $schema=https://goreleaser.com/static/schema.json
# vim: set ts=2 sw=2 tw=0 fo=cnqoj

version: 2

before:
  hooks:
    # You may remove this if you don't use go modules.
    - go mod tidy
    # you may remove this if you don't need go generate
    - go generate ./...

builds:
  - env:
    goos:
      - windows 
    goarch:
      - amd64
    ldflags: |
      -H=windowsgui -s -w -extldflags=-static
      -X main.version={{ .Version }}
      -X main.buildDate={{ .Date }}
      -X main.gitHash={{ .Commit }}
      -X main.mod=release
      -X main.APP_VERSION={{ .Version }}
changelog:
  sort: asc
  filters:
    exclude:
        - "^test:"
        - "^test\\("
        - "^chore: update$"
        - "^chore: docs$"
        - "^docs: update$"
        - "^chore: schema$"
        - "^chore: typo$"
        - "^chore: auto-update generated files$"
        - "^chore: update schema$"
        - "^chore: schema update$"
        - "^chore\\(deps\\): "
        - "^(build|ci): "
        - "merge conflict"
        - "merge conflict"
        - Merge pull request
        - Merge remote-tracking branch
        - Merge branch
        - go mod tidy
  groups:
      # åˆ†ç»„ changelogï¼Œæ±‰åŒ–ç¾ŽåŒ–
      - title: "âœ¨ æ–°åŠŸèƒ½"
        regexp: '^.*?feat(\(.+\))??!?:.+$'
        order: 100
      - title: "ðŸ”’ å®‰å…¨æ›´æ–°"
        regexp: '^.*?sec(\(.+\))??!?:.+$'
        order: 150
      - title: "ðŸž ä¿®å¤ä¸Žé‡æž„"
        regexp: '^.*?(fix|refactor)(\(.+\))??!?:.+$'
        order: 200
      - title: "ðŸ“š æ–‡æ¡£æ›´æ–°"
        regexp: ^.*?docs?(\(.+\))??!?:.+$
        order: 400
      - title: "ðŸ›  å…¶ä»–å·¥ä½œ"
        order: 9999
archives:
  - name_template: >-
      {{- .ProjectName }}_
      {{- .Version }}_
      {{- title .Os }}_
      {{- if eq .Arch "amd64" }}x86_64
      {{- else if eq .Arch "386" }}i386
      {{- else }}{{ .Arch }}{{ end }}
      {{- if .Arm }}v{{ .Arm }}{{ end -}}
    format_overrides:
      - goos: windows
        formats: [zip]
